#include "_doctype.html"
<HTML>
<HEAD> <TITLE>cURL - Security</TITLE>
#include "css.t"
#include "manpage.t"
</HEAD>

#define CURL_DOCS
#define DOCS_SECURITY
#define CURL_URL docs/security.html

#include "_menu.html"
#include "setup.t"

WHERE2(Docs, "/docs/", Security)

TITLE(curl Security)
<div class="relatedbox">
<b>Related:</b>
<br><a href="manual.html">Manual</a>
<br><a href="faq.html">FAQ</a>
<br><a href="/changes.html">Changelog</a>
<br><a href="http://www.gnu.org/software/gnutls/security.html">GnuTLS sec</a>
<br><a href="http://www.openssl.org/news/vulnerabilities.html">OpenSSL sec</a>
</div>

<p>
 We take security seriously and develop curl and libcurl to be secure and
 safe.
<p>
 If you find or simply suspect a security problem in curl or libcurl, mail us
 at <a href="mailto:curl-security at haxx.se">curl-security at haxx.se</a>
 (closed list of receivers, mails are not disclosed) and tell.
<p>
 We appreciate getting notified in advance before you go public with security
 advisories for the sake of our users.
<p>
 See also the <a href="vulnerabilities.html">Vulnerabilties Table</a> to see
 what versions that are vulnerable to what flaws.

<a name="20070710"></a>
SUBTITLE(libcurl GnuTLS insufficient cert verification)
<p>
<table class="secbox">
  <tr><td>Date:</td><td>July 10, 2007</td></tr>
  <tr><td>ID</td><td>
<a href="http://www.securityfocus.com/bid/24938">BID 24938</a>
#if 0
<a href="http://secunia.com/advisories/19271/">SA19271</a>
#endif
<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-3564">CVE-2007-3564</a>
<small><a href="#20070710">(permalink)</a></small></td></tr>
  <tr><td>Affected versions</td><td>7.14.0 to and including 7.16.3</td></tr>
  <tr><td>Not affected versions</td><td>7.13.2 and earlier, 7.16.4 and later</td></tr>
  <tr><td>Patch</td><td><a href="http://curl.haxx.se/libcurl-gnutlscert.patch">libcurl-gnutlscert.patch</a></td></tr>

  <tr><td>Advisories</td><td>
<a href="adv_20070710.html">Project cURL Security Advisory</a> </td></tr>

</table>
<p>
libcurl (when built to use GnuTLS) fails to verify that a peer's certificate
hasn't already expired or hasn't yet become valid. This allows malicious
servers to present certificates to libcurl that won't be rejected properly.
<p>
Notably, the cacert and common name checks are still in place which reduces
the risk for random servers to take advantage of this flaw.


<a name="BID17154"></a>
<a name="20060320"></a>
SUBTITLE(libcurl TFTP Packet Buffer Overflow)
<p>
<table class="secbox">
  <tr><td>Date:</td><td>March 20, 2006</td></tr>
  <tr><td>ID</td><td>
<a href="http://www.securityfocus.com/bid/17154">BID 17154</a>
<a href="http://secunia.com/advisories/19271/">SA19271</a>
<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-1061">CVE-2006-1061</a>
<small><a href="#20060320">(permalink)</a></small></td></tr>
  <tr><td>Affected versions</td><td>7.15.0 to and including 7.15.2</td></tr>
  <tr><td>Not affected versions</td><td>7.14.1 and earlier, 7.15.3 and later</td></tr>
  <tr><td>Patch</td><td><a href="http://curl.haxx.se/libcurl-tftp.patch">libcurl-tftp.patch</a></td></tr>

  <tr><td>Advisories</td><td>
<a href="adv_20060320.html">Project cURL Security  Advisory</a> </td></tr>

</table>
<p>
libcurl uses the given file part of a TFTP URL in a manner that allows a
malicious user to overflow a heap-based memory buffer due to the lack of
boundary check.


<a name="BID15756"></a><a name="20051207"></a>
SUBTITLE(libcurl URL Buffer Overflow)
<p>
<table class="secbox">
  <tr><td>Date:</td><td>December 7, 2005</td></tr>
  <tr><td>ID</td><td><a href="http://www.securityfocus.com/bid/15756">BID 15756</a> <a href="http://secunia.com/advisories/17907/">SA17907</a> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-4077">CVE-2005-4077</a> <small><a href="#20051207">(permalink)</a></small></td></tr>
  <tr><td>Affected versions</td><td>7.11.2 to and including 7.15.0</td></tr>
  <tr><td>Not affected versions</td><td>7.11.1 and earlier, 7.15.1 and later</td></tr>
  <tr><td>Patch</td><td><a href="http://curl.haxx.se/libcurl-urllen.patch">libcurl-urllen.patch</a> (<b>Note:</b> for 7.14.0 and earlier the patch <i>MUST</i> be made to do +3 and <i>not</i> just +2.</td></tr>

  <tr><td>Advisories</td><td>
<a href="adv_20051207.html">Project cURL Security
  Advisory</a>  <a href="http://www.hardened-php.net/advisory_242005.109.html">Hardened-PHP Advisory</a></td></tr>

</table>
<p>
 libcurl's URL parser function can overflow a malloced buffer in two ways, if
 given a too long URL.


<a name="BID15102"></a><a name="CAN-2005-3185"></a>
SUBTITLE(libcurl NTLM Buffer Overflow)
<p>
<table class="secbox">
  <tr><td>Date:</td><td>October 13, 2005</td></tr>
  <tr><td>ID</td><td><a href="http://www.securityfocus.com/bid/15102">BID 15102</a> <a
  href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2005-3185">CAN-2005-3185</a> <small><a href="#BID15102">(permalink)</a></small></td></tr>
  <tr><td>Affected versions</td><td>7.10.6 to and including 7.14.1</td></tr>
  <tr><td>Not affected versions</td><td>7.10.5 and earlier, 7.15.0 and later</td></tr>
  <tr><td>Patch</td><td><a href="http://curl.haxx.se/libcurl-ntlmbuf.patch">libcurl-ntlmbuf.patch</a></td></tr>
  <tr><td>Advisories</td><td><a href="adv_20051013.html">Project cURL Security Advisory</a>,  <a
  href="http://www.idefense.com/application/poi/display?id=322&type=vulnerabilities">iDEFENSE's
  advisory</a></td></tr>
</table>
<p>
 libcurl's NTLM function can overflow a stack-based buffer if given a too long
 user name or domain name. This would happen if you enable NTLM authentication
 and either:
<ol>
 <li> pass in a user name and domain name to libcurl that together are longer
     than 192 bytes

 <li> allow (lib)curl to follow HTTP "redirects" (Location: and the appropriate
     HTTP 30x response code) and the new URL contains a URL with a user name
     and domain name that together are longer than 192 bytes
</ol>
<p>
  There is no known exploit/malicious server at the time of this writing.
<p>
  The <a
  href="http://article.gmane.org/gmane.comp.web.wget.general/5064">notification
  mail</a> to us about this flaw was also sent to a public wget mailing list
  and thus became public immediately.

<a name="BID12616"></a><a name="CAN-2005-0490"></a>
SUBTITLE(Kerberos Authentication Buffer Overflow)
<p>
<table class="secbox">
  <tr><td>Date:</td><td>February 21, 2005</td></tr>
  <tr><td>ID</td><td><a href="http://www.securityfocus.com/bid/12616">BID
  12616</a> <a
  href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2005-0490">CAN-2005-0490</a> <small><a href="#BID12616">(permalink)</a></small> </td></tr>
  <tr><td>Affected versions</td><td>7.3 to and including 7.13.0</td></tr>
  <tr><td>Not affected versions</td><td>7.13.1 and later</td></tr>
  <tr><td>Advisories</td><td><a
  href="http://www.idefense.com/application/poi/display?id=203">iDEFENSE's
  advisory</a></td></tr>
</table>

<p>
  Due to bad usage of the base64 decode function to a
  stack-based buffer without checking the data length, it was possible for a
  malicious FTP server to overflow the client during krb4 negotiation. I don't
  know of any single user that uses krb4-ftp and I'm not even sure it still
  works 100%. The <a
  href="http://www.idefense.com/application/poi/display?id=203">announcement</a>
  was done without contacting us.

<a name="BID12615"></a>
SUBTITLE(NTLM Authentication Buffer Overflow)
<p>
<table class="secbox">
  <tr><td>Date:</td><td>February 21, 2005</td></tr>
  <tr><td>ID</td><td><a href="http://www.securityfocus.com/bid/12615">BID
  12615</a> <a
  href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2005-0490">CAN-2005-0490</a>  <small><a href="#BID12615">(permalink)</a></small> </td></tr>
  <tr><td>Affected versions</td><td>7.10.6 to and including 7.13.0</td></tr>
  <tr><td>Not affected versions</td><td>7.13.1 and later</td></tr>
  <tr><td>Advisories</td><td><a
  href="http://www.idefense.com/application/poi/display?id=202">iDEFENSE's
  advisory</a></td></tr>
</table>
 <p>
  Due to bad usage of the base64 decode function to a stack-based buffer
  without checking the data length, it was possible for a malicious HTTP
  server to overflow the client during NTLM negotiation. The <a
  href="http://www.idefense.com/application/poi/display?id=202">announcement</a>
  was done without contacting us.

<a name="BID8432"></a>
SUBTITLE(Proxy Authentication Header Information Leakage)
<p>
<table class="secbox">
  <tr><td>Date:</td><td>August 3, 2003</td></tr>
  <tr><td>ID</td><td><a href="http://www.securityfocus.com/bid/8432">BID 8432</a>  <small><a href="#BID8432">(permalink)</a></small></td></tr>
  <tr><td>Affected versions</td><td>7.1 to and including 7.10.6</td></tr>
  <tr><td>Not affected versions</td><td>7.10.7 and later</td></tr>
</table>
<p>
  When curl connected to a site via an HTTP proxy with the CONNECT request, the
  user and password used for the proxy connection was also sent off to the
  remote server.

<a name="BID1804"></a>
SUBTITLE(FTP Server Response Buffer Overflow)
<o>
<table class="secbox">
  <tr><td>Date:</td><td>October 13, 2000</td></tr>
  <tr><td>ID</td><td> <a href="http://www.securityfocus.com/bid/1804">BID
  1804</a> <a
  href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0973">CVE-2000-0973</a>  <small><a href="#BID1804">(permalink)</a></small></td></tr>
  <tr><td>Affected versions</td><td>6.0 (and possibly earlier) to and including 7.4</td></tr>
  <tr><td>Not affected versions</td><td>7.4.1 and later</td></tr>
</table>
<p>
  When storing an FTP server's error message on failure, there was no check
  for input length and thus a malicious FTP server could overflow curl's stack
  based buffer. <a
  href="http://www.securityfocus.com/bid/1804/exploit/">securityfocus lists
  two exploits</a>

#include "_footer.html"
</body> </html>
